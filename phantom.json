[
  {
    "remarks": "1 BPB (old version)",
    "log": {
      "loglevel": "warning"
    },
    "dns": {
      "hosts": {
        "geosite:category-ads-all": [
          "127.0.0.1"
        ],
        "geosite:category-ads-ir": [
          "127.0.0.1"
        ],
        "cloudflare-dns.com": [
          "cloudflare.com"
        ]
      },
      "servers": [
        {
          "address": "fakedns",
          "domains": [
            "geosite:category-ir",
            "full:cloudflare.com"
          ]
        },
        {
          "address": "https://cloudflare-dns.com/dns-query",
          "tag": "remote-dns"
        },
        {
          "address": "8.8.8.8",
          "domains": [
            "geosite:category-ir"
          ],
          "expectIPs": [
            "geoip:ir"
          ]
        },
        {
          "address": "8.8.8.8",
          "domains": [
            "full:cloudflare.com"
          ]
        }
      ],
      "queryStrategy": "UseIP",
      "tag": "dns",
      "disableFallbackIfMatch": true
    },
    "inbounds": [
      {
        "port": 10808,
        "protocol": "socks",
        "settings": {
          "auth": "noauth",
          "udp": true,
          "userLevel": 8
        },
        "sniffing": {
          "destOverride": [
            "http",
            "tls",
            "fakedns"
          ],
          "enabled": true,
          "routeOnly": true
        },
        "tag": "socks-in"
      },
      {
        "port": 10853,
        "protocol": "dokodemo-door",
        "settings": {
          "address": "1.1.1.1",
          "network": "tcp,udp",
          "port": 53
        },
        "tag": "dns-in"
      }
    ],
    "outbounds": [
      {
        "tag": "fragment",
        "protocol": "freedom",
        "settings": {
          "fragment": {
            "packets": "tlshello",
            "length": "100-200",
            "interval": "1-1"
          },
          "domainStrategy": "UseIPv4v6",
          "noises": [
            {
              "type": "rand",
              "packet": "50-100",
              "delay": "1-1"
            },
            {
              "type": "rand",
              "packet": "50-100",
              "delay": "1-1"
            },
            {
              "type": "rand",
              "packet": "50-100",
              "delay": "1-1"
            },
            {
              "type": "rand",
              "packet": "50-100",
              "delay": "1-1"
            },
            {
              "type": "rand",
              "packet": "50-100",
              "delay": "1-1"
            }
          ]
        }
      },
      {
        "protocol": "dns",
        "tag": "dns-out"
      },
      {
        "protocol": "freedom",
        "settings": {
          "domainStrategy": "UseIP"
        },
        "tag": "direct"
      },
      {
        "protocol": "blackhole",
        "settings": {
          "response": {
            "type": "http"
          }
        },
        "tag": "block"
      }
    ],
    "policy": {
      "levels": {
        "8": {
          "connIdle": 300,
          "downlinkOnly": 1,
          "handshake": 4,
          "uplinkOnly": 1
        }
      },
      "system": {
        "statsOutboundUplink": true,
        "statsOutboundDownlink": true
      }
    },
    "routing": {
      "domainStrategy": "IPIfNonMatch",
      "rules": [
        {
          "inboundTag": [
            "socks-in"
          ],
          "port": 53,
          "outboundTag": "dns-out",
          "type": "field"
        },
        {
          "inboundTag": [
            "dns-in"
          ],
          "outboundTag": "dns-out",
          "type": "field"
        },
        {
          "inboundTag": [
            "remote-dns"
          ],
          "outboundTag": "fragment",
          "type": "field"
        },
        {
          "inboundTag": [
            "dns"
          ],
          "outboundTag": "direct",
          "type": "field"
        },
        {
          "domain": [
            "geosite:category-ads-all",
            "geosite:category-ads-ir"
          ],
          "outboundTag": "block",
          "type": "field"
        },
        {
          "domain": [
            "geosite:category-ir"
          ],
          "outboundTag": "direct",
          "type": "field"
        },
        {
          "ip": [
            "geoip:ir"
          ],
          "outboundTag": "direct",
          "type": "field"
        },
        {
          "network": "tcp,udp",
          "outboundTag": "fragment",
          "type": "field"
        }
      ]
    },
    "stats": {}
  },
  {
    "remarks": "2 BPB (new version)",
    "log": {
      "loglevel": "warning"
    },
    "dns": {
      "hosts": {
        "geosite:category-ads-all": [
          "127.0.0.1"
        ],
        "geosite:category-ads-ir": [
          "127.0.0.1"
        ],
        "dns.google": [
          "8.8.8.8",
          "8.8.4.4"
        ]
      },
      "servers": [
        {
          "address": "fakedns",
          "domains": [
            "geosite:category-ir"
          ]
        },
        {
          "address": "https://dns.google/dns-query",
          "tag": "remote-dns"
        },
        {
          "address": "8.8.8.8",
          "domains": [
            "geosite:category-ir"
          ],
          "expectIPs": [
            "geoip:ir"
          ]
        }
      ],
      "queryStrategy": "UseIP",
      "tag": "dns",
      "disableFallbackIfMatch": true
    },
    "inbounds": [
      {
        "port": 10808,
        "protocol": "socks",
        "settings": {
          "auth": "noauth",
          "udp": true,
          "userLevel": 8
        },
        "sniffing": {
          "destOverride": [
            "http",
            "tls",
            "fakedns"
          ],
          "enabled": true,
          "routeOnly": true
        },
        "tag": "socks-in"
      },
      {
        "port": 10853,
        "protocol": "dokodemo-door",
        "settings": {
          "address": "1.1.1.1",
          "network": "tcp,udp",
          "port": 53
        },
        "tag": "dns-in"
      }
    ],
    "outbounds": [
      {
        "tag": "fragment",
        "protocol": "freedom",
        "settings": {
          "fragment": {
            "packets": "tlshello",
            "length": "100-200",
            "interval": "1-1"
          },
          "domainStrategy": "UseIPv4v6",
          "noises": [
            {
              "type": "rand",
              "packet": "50-100",
              "delay": "1-1"
            },
            {
              "type": "rand",
              "packet": "50-100",
              "delay": "1-1"
            },
            {
              "type": "rand",
              "packet": "50-100",
              "delay": "1-1"
            },
            {
              "type": "rand",
              "packet": "50-100",
              "delay": "1-1"
            },
            {
              "type": "rand",
              "packet": "50-100",
              "delay": "1-1"
            }
          ]
        }
      },
      {
        "protocol": "dns",
        "tag": "dns-out"
      },
      {
        "protocol": "freedom",
        "settings": {
          "domainStrategy": "UseIP"
        },
        "tag": "direct"
      },
      {
        "protocol": "blackhole",
        "settings": {
          "response": {
            "type": "http"
          }
        },
        "tag": "block"
      }
    ],
    "policy": {
      "levels": {
        "8": {
          "connIdle": 300,
          "downlinkOnly": 1,
          "handshake": 4,
          "uplinkOnly": 1
        }
      },
      "system": {
        "statsOutboundUplink": true,
        "statsOutboundDownlink": true
      }
    },
    "routing": {
      "domainStrategy": "IPIfNonMatch",
      "rules": [
        {
          "inboundTag": [
            "socks-in"
          ],
          "port": 53,
          "outboundTag": "dns-out",
          "type": "field"
        },
        {
          "inboundTag": [
            "dns-in"
          ],
          "outboundTag": "dns-out",
          "type": "field"
        },
        {
          "inboundTag": [
            "remote-dns"
          ],
          "outboundTag": "fragment",
          "type": "field"
        },
        {
          "inboundTag": [
            "dns"
          ],
          "outboundTag": "direct",
          "type": "field"
        },
        {
          "domain": [
            "geosite:category-ads-all",
            "geosite:category-ads-ir"
          ],
          "outboundTag": "block",
          "type": "field"
        },
        {
          "domain": [
            "geosite:category-ir"
          ],
          "outboundTag": "direct",
          "type": "field"
        },
        {
          "ip": [
            "geoip:ir"
          ],
          "outboundTag": "direct",
          "type": "field"
        },
        {
          "network": "tcp,udp",
          "outboundTag": "fragment",
          "type": "field"
        }
      ]
    },
    "stats": {}
  },
  {
    "remarks": "3 Knocker (tlshello)",
    "log": {
      "access": "",
      "error": "",
      "loglevel": "none",
      "dnsLog": false
    },
    "dns": {
      "tag": "dns",
      "hosts": {
        "dns.google": [
          "8.8.8.8",
          "8.8.4.4"
        ],
        "domain:youtube.com": [
          "google.com"
        ]
      },
      "servers": [
        "https://dns.google/dns-query"
      ]
    },
    "inbounds": [
      {
        "domainOverride": [
          "http",
          "tls"
        ],
        "protocol": "socks",
        "tag": "socks-in",
        "listen": "127.0.0.1",
        "port": 10808,
        "settings": {
          "auth": "noauth",
          "udp": true,
          "userLevel": 8
        },
        "sniffing": {
          "enabled": true,
          "destOverride": [
            "http",
            "tls"
          ]
        }
      },
      {
        "protocol": "http",
        "tag": "http-in",
        "listen": "127.0.0.1",
        "port": 10809,
        "settings": {
          "userLevel": 8
        },
        "sniffing": {
          "enabled": true,
          "destOverride": [
            "http",
            "tls"
          ]
        }
      }
    ],
    "outbounds": [
      {
        "protocol": "freedom",
        "tag": "fragment-out",
        "domainStrategy": "UseIP",
        "sniffing": {
          "enabled": true,
          "destOverride": [
            "http",
            "tls"
          ]
        },
        "settings": {
          "fragment": {
            "packets": "tlshello",
            "length": "10-20",
            "interval": "10-20"
          }
        },
        "streamSettings": {
          "sockopt": {
            "tcpNoDelay": true,
            "tcpKeepAliveIdle": 100,
            "mark": 255,
            "domainStrategy": "UseIP"
          }
        }
      },
      {
        "protocol": "dns",
        "tag": "dns-out"
      },
      {
        "protocol": "vless",
        "tag": "fakeproxy-out",
        "domainStrategy": "",
        "settings": {
          "vnext": [
            {
              "address": "google.com",
              "port": 443,
              "users": [
                {
                  "encryption": "none",
                  "flow": "",
                  "id": "UUID",
                  "level": 8,
                  "security": "auto"
                }
              ]
            }
          ]
        },
        "streamSettings": {
          "network": "ws",
          "security": "tls",
          "tlsSettings": {
            "allowInsecure": false,
            "alpn": [
              "h2",
              "http/1.1"
            ],
            "fingerprint": "randomized",
            "publicKey": "",
            "serverName": "google.com",
            "shortId": "",
            "show": false,
            "spiderX": ""
          },
          "wsSettings": {
            "headers": {
              "Host": "google.com"
            },
            "path": "/"
          }
        },
        "mux": {
          "concurrency": 8,
          "enabled": false
        }
      }
    ],
    "policy": {
      "levels": {
        "8": {
          "connIdle": 300,
          "downlinkOnly": 1,
          "handshake": 4,
          "uplinkOnly": 1
        }
      },
      "system": {
        "statsOutboundUplink": true,
        "statsOutboundDownlink": true
      }
    },
    "routing": {
      "domainStrategy": "IPIfNonMatch",
      "rules": [
        {
          "inboundTag": [
            "socks-in",
            "http-in"
          ],
          "type": "field",
          "port": "53",
          "outboundTag": "dns-out",
          "enabled": true
        },
        {
          "inboundTag": [
            "socks-in",
            "http-in"
          ],
          "type": "field",
          "port": "0-65535",
          "outboundTag": "fragment-out",
          "enabled": true
        }
      ],
      "strategy": "rules"
    },
    "stats": {}
  },
  {
    "remarks": "4 Patterniha (old version)",
    "log": {
      "loglevel": "warning",
      "dnsLog": false,
      "access": "none"
    },
    "dns": {
      "hosts": {
        "geosite:category-ads-all": [
          "10.10.34.36",
          "2001:4188:2:600:10:10:34:36"
        ],
        "dns.cloudflare.com": "cloudflare.com"
      },
      "servers": [
        "https://dns.cloudflare.com/dns-query",
        {
          "address": "localhost",
          "domains": [
            "geosite:private",
            "geosite:category-ir",
            "full:cloudflare.com"
          ]
        }
      ],
      "tag": "dns-query",
      "disableFallback": true
    },
    "inbounds": [
      {
        "tag": "dns-in",
        "port": 10853,
        "protocol": "dokodemo-door",
        "settings": {
          "address": "1.1.1.1",
          "port": 53,
          "network": "tcp,udp"
        }
      },
      {
        "tag": "socks-in",
        "port": 10808,
        "protocol": "socks",
        "sniffing": {
          "enabled": true,
          "destOverride": [
            "http",
            "tls"
          ],
          "routeOnly": false
        },
        "settings": {
          "udp": true
        }
      }
    ],
    "outbounds": [
      {
        "tag": "block",
        "protocol": "blackhole"
      },
      {
        "tag": "direct",
        "protocol": "freedom",
        "settings": {
          "domainStrategy": "ForceIP"
        }
      },
      {
        "tag": "dns-out",
        "protocol": "dns",
        "settings": {
          "nonIPQuery": "skip",
          "network": "tcp",
          "address": "1.1.1.1",
          "port": 53
        },
        "streamSettings": {
          "sockopt": {
            "dialerProxy": "chain1-fragment"
          }
        }
      },
      {
        "tag": "super-fragment",
        "protocol": "freedom",
        "settings": {
          "fragment": {
            "packets": "tlshello",
            "length": "6",
            "interval": "0"
          }
        },
        "streamSettings": {
          "sockopt": {
            "dialerProxy": "chain1-fragment"
          }
        }
      },
      {
        "tag": "chain1-fragment",
        "protocol": "freedom",
        "settings": {
          "fragment": {
            "packets": "1-3",
            "length": "517",
            "interval": "1"
          }
        },
        "streamSettings": {
          "sockopt": {
            "dialerProxy": "chain2-fragment"
          }
        }
      },
      {
        "tag": "chain2-fragment",
        "protocol": "freedom",
        "settings": {
          "domainStrategy": "ForceIP",
          "fragment": {
            "packets": "1-1",
            "length": "1",
            "interval": "2"
          }
        }
      },
      {
        "tag": "udp-noisesv4",
        "protocol": "freedom",
        "settings": {
          "domainStrategy": "ForceIPv4",
          "noises": [
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10"
            }
          ]
        }
      },
      {
        "tag": "udp-noisesv6",
        "protocol": "freedom",
        "settings": {
          "domainStrategy": "ForceIPv6",
          "noises": [
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10"
            }
          ]
        }
      }
    ],
    "routing": {
      "domainStrategy": "IPOnDemand",
      "rules": [
        {
          "outboundTag": "dns-out",
          "inboundTag": [
            "dns-in"
          ]
        },
        {
          "outboundTag": "dns-out",
          "inboundTag": [
            "socks-in"
          ],
          "port": 53
        },
        {
          "outboundTag": "chain1-fragment",
          "inboundTag": [
            "dns-query"
          ]
        },
        {
          "outboundTag": "block",
          "domain": [
            "geosite:category-ads-all"
          ]
        },
        {
          "outboundTag": "block",
          "ip": [
            "10.10.34.0/24",
            "2001:4188:2:600:10:10:34:36",
            "2001:4188:2:600:10:10:34:35",
            "2001:4188:2:600:10:10:34:34"
          ]
        },
        {
          "outboundTag": "direct",
          "domain": [
            "geosite:private",
            "geosite:category-ir"
          ]
        },
        {
          "outboundTag": "direct",
          "ip": [
            "geoip:private",
            "geoip:ir"
          ]
        },
        {
          "outboundTag": "udp-noisesv4",
          "network": "udp",
          "ip": [
            "0.0.0.0/0"
          ],
          "port": 443
        },
        {
          "outboundTag": "udp-noisesv6",
          "network": "udp",
          "ip": [
            "::/0"
          ],
          "port": 443
        },
        {
          "outboundTag": "direct",
          "network": "udp"
        },
        {
          "outboundTag": "chain1-fragment",
          "network": "tcp"
        }
      ]
    }
  },
  {
    "remarks": "5 Patterniha (new version)",
    "version": {
      "min": "25.9.5"
    },
    "log": {
      "loglevel": "warning",
      "dnsLog": false,
      "access": "none"
    },
    "policy": {
      "levels": {
        "0": {
          "uplinkOnly": 0,
          "downlinkOnly": 0
        }
      }
    },
    "dns": {
      "hosts": {
        "geosite:category-ads-all": "#3",
        "one.one.one.one": [
          "1.1.1.1",
          "1.0.0.1",
          "2606:4700:4700::1111",
          "2606:4700:4700::1001"
        ],
        "cloudflare-dns.com": "www.cloudflare.com"
      },
      "servers": [
        {
          "address": "fakedns",
          "domains": [
            "domain:ir",
            "geosite:private",
            "geosite:ir",
            "full:www.cloudflare.com",
            "domain:dynx.pro",
            "geosite:sanctioned"
          ],
          "finalQuery": true
        },
        {
          "tag": "no-filter-dns",
          "address": "https://cloudflare-dns.com/dns-query",
          "timeoutMs": 5000,
          "finalQuery": true
        },
        {
          "address": "localhost",
          "domains": [
            "domain:ir",
            "geosite:private",
            "geosite:ir",
            "full:www.cloudflare.com",
            "domain:dynx.pro"
          ],
          "finalQuery": true
        },
        {
          "tag": "anti-sanction-dns",
          "address": "localhost",
          "domains": [
            "geosite:sanctioned"
          ],
          "unexpectedIPs": [
            "geoip:irgfw-all-injected-ips",
            "0.0.0.0",
            "::",
            "127.0.0.1",
            "::1"
          ],
          "timeoutMs": 2000,
          "finalQuery": false
        }
      ],
      "queryStrategy": "UseSystem",
      "useSystemHosts": true
    },
    "inbounds": [
      {
        "tag": "dns-in",
        "listen": "127.0.0.1",
        "port": 10853,
        "protocol": "tunnel",
        "settings": {
          "address": "one.one.one.one",
          "port": 53,
          "network": "tcp,udp"
        },
        "streamSettings": {
          "sockopt": {
            "tcpKeepAliveInterval": 1,
            "tcpKeepAliveIdle": 46
          }
        }
      },
      {
        "tag": "socks-in",
        "listen": "127.0.0.1",
        "port": 10808,
        "protocol": "mixed",
        "sniffing": {
          "enabled": true,
          "destOverride": [
            "fakedns"
          ],
          "routeOnly": false
        },
        "settings": {
          "udp": true,
          "ip": "127.0.0.1"
        },
        "streamSettings": {
          "sockopt": {
            "tcpKeepAliveInterval": 1,
            "tcpKeepAliveIdle": 46
          }
        }
      }
    ],
    "outbounds": [
      {
        "tag": "block-out",
        "protocol": "block"
      },
      {
        "tag": "direct-out",
        "protocol": "direct",
        "streamSettings": {
          "sockopt": {
            "domainStrategy": "ForceIP",
            "happyEyeballs": {
              "tryDelayMs": 100,
              "prioritizeIPv6": true,
              "interleave": 2,
              "maxConcurrentTry": 16
            }
          }
        }
      },
      {
        "tag": "dns-out",
        "protocol": "dns",
        "settings": {
          "nonIPQuery": "skip",
          "network": "tcp",
          "address": "one.one.one.one",
          "port": 53
        },
        "streamSettings": {
          "sockopt": {
            "dialerProxy": "full-fragment"
          }
        }
      },
      {
        "tag": "skip-fragment",
        "protocol": "direct",
        "settings": {
          "fragment": {
            "packets": "1-1",
            "length": "130",
            "interval": "190",
            "maxSplit": "4"
          }
        },
        "streamSettings": {
          "sockopt": {
            "dialerProxy": "_chain-skip"
          }
        }
      },
      {
        "tag": "_chain-skip",
        "protocol": "direct",
        "settings": {
          "fragment": {
            "packets": "2-4",
            "length": "1",
            "interval": "1",
            "maxSplit": "130"
          }
        },
        "streamSettings": {
          "sockopt": {
            "domainStrategy": "ForceIP",
            "happyEyeballs": {
              "tryDelayMs": 300,
              "prioritizeIPv6": true,
              "interleave": 2,
              "maxConcurrentTry": 16
            }
          }
        }
      },
      {
        "tag": "full-fragment",
        "protocol": "direct",
        "settings": {
          "fragment": {
            "packets": "1-1",
            "length": "1",
            "interval": "1",
            "maxSplit": "517"
          }
        },
        "streamSettings": {
          "sockopt": {
            "domainStrategy": "ForceIP",
            "happyEyeballs": {
              "tryDelayMs": 300,
              "prioritizeIPv6": true,
              "interleave": 2,
              "maxConcurrentTry": 16
            }
          }
        }
      },
      {
        "tag": "udp-noises",
        "protocol": "direct",
        "settings": {
          "targetStrategy": "ForceIP",
          "noises": [
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            }
          ]
        }
      }
    ],
    "routing": {
      "domainStrategy": "IPOnDemand",
      "rules": [
        {
          "outboundTag": "block-out",
          "domain": [
            "geosite:category-ads-all"
          ]
        },
        {
          "outboundTag": "dns-out",
          "inboundTag": [
            "dns-in"
          ]
        },
        {
          "outboundTag": "dns-out",
          "inboundTag": [
            "socks-in"
          ],
          "port": 53
        },
        {
          "outboundTag": "direct-out",
          "inboundTag": [
            "anti-sanction-dns"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "inboundTag": [
            "no-filter-dns"
          ]
        },
        {
          "outboundTag": "block-out",
          "ip": [
            "geoip:irgfw-block-injected-ips",
            "0.0.0.0",
            "::"
          ]
        },
        {
          "outboundTag": "direct-out",
          "domain": [
            "domain:ir",
            "geosite:private",
            "geosite:ir",
            "domain:dynx.pro"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "direct-out",
          "ip": [
            "geoip:private",
            "geoip:ir"
          ]
        },
        {
          "outboundTag": "udp-noises",
          "network": "udp",
          "protocol": [
            "quic"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "udp-noises",
          "network": "udp",
          "port": "443,2053,2083,2087,2096,8443",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "direct-out",
          "network": "udp",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "protocol": [
            "tls"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "port": "443,2053,2083,2087,2096,8443",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "protocol": [
            "http"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "port": "80,8080,8880,2052,2082,2086,2095",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "block-out",
          "network": "tcp,udp"
        }
      ]
    }
  },
  {
    "remarks": "6 Patterniha (new version shecan)",
    "version": {
      "min": "25.9.5"
    },
    "log": {
      "loglevel": "warning",
      "dnsLog": false,
      "access": "none"
    },
    "policy": {
      "levels": {
        "0": {
          "uplinkOnly": 0,
          "downlinkOnly": 0
        }
      }
    },
    "dns": {
      "hosts": {
        "geosite:category-ads-all": "#3",
        "one.one.one.one": [
          "1.1.1.1",
          "1.0.0.1",
          "2606:4700:4700::1111",
          "2606:4700:4700::1001"
        ],
        "cloudflare-dns.com": "www.cloudflare.com"
      },
      "servers": [
        {
          "address": "fakedns",
          "domains": [
            "domain:ir",
            "geosite:private",
            "geosite:ir",
            "full:www.cloudflare.com",
            "domain:dynx.pro",
            "geosite:sanctioned"
          ],
          "finalQuery": true
        },
        {
          "tag": "no-filter-dns",
          "address": "https://cloudflare-dns.com/dns-query",
          "timeoutMs": 5000,
          "finalQuery": true
        },
        {
          "address": "localhost",
          "domains": [
            "domain:ir",
            "geosite:private",
            "geosite:ir",
            "full:www.cloudflare.com",
            "domain:dynx.pro"
          ],
          "finalQuery": true
        },
        {
          "tag": "anti-sanction-dns",
          "address": "https://free.shecan.ir/dns-query",
          "domains": [
            "geosite:sanctioned"
          ],
          "unexpectedIPs": [
            "geoip:irgfw-all-injected-ips",
            "0.0.0.0",
            "::",
            "127.0.0.1",
            "::1"
          ],
          "timeoutMs": 2000,
          "finalQuery": false
        }
      ],
      "queryStrategy": "UseSystem",
      "useSystemHosts": true
    },
    "inbounds": [
      {
        "tag": "dns-in",
        "listen": "127.0.0.1",
        "port": 10853,
        "protocol": "tunnel",
        "settings": {
          "address": "one.one.one.one",
          "port": 53,
          "network": "tcp,udp"
        },
        "streamSettings": {
          "sockopt": {
            "tcpKeepAliveInterval": 1,
            "tcpKeepAliveIdle": 46
          }
        }
      },
      {
        "tag": "socks-in",
        "listen": "127.0.0.1",
        "port": 10808,
        "protocol": "mixed",
        "sniffing": {
          "enabled": true,
          "destOverride": [
            "fakedns"
          ],
          "routeOnly": false
        },
        "settings": {
          "udp": true,
          "ip": "127.0.0.1"
        },
        "streamSettings": {
          "sockopt": {
            "tcpKeepAliveInterval": 1,
            "tcpKeepAliveIdle": 46
          }
        }
      }
    ],
    "outbounds": [
      {
        "tag": "block-out",
        "protocol": "block"
      },
      {
        "tag": "direct-out",
        "protocol": "direct",
        "streamSettings": {
          "sockopt": {
            "domainStrategy": "ForceIP",
            "happyEyeballs": {
              "tryDelayMs": 100,
              "prioritizeIPv6": true,
              "interleave": 2,
              "maxConcurrentTry": 16
            }
          }
        }
      },
      {
        "tag": "dns-out",
        "protocol": "dns",
        "settings": {
          "nonIPQuery": "skip",
          "network": "tcp",
          "address": "one.one.one.one",
          "port": 53
        },
        "streamSettings": {
          "sockopt": {
            "dialerProxy": "full-fragment"
          }
        }
      },
      {
        "tag": "skip-fragment",
        "protocol": "direct",
        "settings": {
          "fragment": {
            "packets": "1-1",
            "length": "130",
            "interval": "190",
            "maxSplit": "4"
          }
        },
        "streamSettings": {
          "sockopt": {
            "dialerProxy": "_chain-skip"
          }
        }
      },
      {
        "tag": "_chain-skip",
        "protocol": "direct",
        "settings": {
          "fragment": {
            "packets": "2-4",
            "length": "1",
            "interval": "1",
            "maxSplit": "130"
          }
        },
        "streamSettings": {
          "sockopt": {
            "domainStrategy": "ForceIP",
            "happyEyeballs": {
              "tryDelayMs": 300,
              "prioritizeIPv6": true,
              "interleave": 2,
              "maxConcurrentTry": 16
            }
          }
        }
      },
      {
        "tag": "full-fragment",
        "protocol": "direct",
        "settings": {
          "fragment": {
            "packets": "1-1",
            "length": "1",
            "interval": "1",
            "maxSplit": "517"
          }
        },
        "streamSettings": {
          "sockopt": {
            "domainStrategy": "ForceIP",
            "happyEyeballs": {
              "tryDelayMs": 300,
              "prioritizeIPv6": true,
              "interleave": 2,
              "maxConcurrentTry": 16
            }
          }
        }
      },
      {
        "tag": "udp-noises",
        "protocol": "direct",
        "settings": {
          "targetStrategy": "ForceIP",
          "noises": [
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            }
          ]
        }
      }
    ],
    "routing": {
      "domainStrategy": "IPOnDemand",
      "rules": [
        {
          "outboundTag": "block-out",
          "domain": [
            "geosite:category-ads-all"
          ]
        },
        {
          "outboundTag": "dns-out",
          "inboundTag": [
            "dns-in"
          ]
        },
        {
          "outboundTag": "dns-out",
          "inboundTag": [
            "socks-in"
          ],
          "port": 53
        },
        {
          "outboundTag": "direct-out",
          "inboundTag": [
            "anti-sanction-dns"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "inboundTag": [
            "no-filter-dns"
          ]
        },
        {
          "outboundTag": "block-out",
          "ip": [
            "geoip:irgfw-block-injected-ips",
            "0.0.0.0",
            "::"
          ]
        },
        {
          "outboundTag": "direct-out",
          "domain": [
            "domain:ir",
            "geosite:private",
            "geosite:ir",
            "domain:dynx.pro"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "direct-out",
          "ip": [
            "geoip:private",
            "geoip:ir"
          ]
        },
        {
          "outboundTag": "udp-noises",
          "network": "udp",
          "protocol": [
            "quic"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "udp-noises",
          "network": "udp",
          "port": "443,2053,2083,2087,2096,8443",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "direct-out",
          "network": "udp",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "protocol": [
            "tls"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "port": "443,2053,2083,2087,2096,8443",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "protocol": [
            "http"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "port": "80,8080,8880,2052,2082,2086,2095",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "block-out",
          "network": "tcp,udp"
        }
      ]
    }
  },
  {
    "remarks": "7 Patterniha (new version dynx)",
    "version": {
      "min": "25.9.5"
    },
    "log": {
      "loglevel": "warning",
      "dnsLog": false,
      "access": "none"
    },
    "policy": {
      "levels": {
        "0": {
          "uplinkOnly": 0,
          "downlinkOnly": 0
        }
      }
    },
    "dns": {
      "hosts": {
        "geosite:category-ads-all": "#3",
        "one.one.one.one": [
          "1.1.1.1",
          "1.0.0.1",
          "2606:4700:4700::1111",
          "2606:4700:4700::1001"
        ],
        "cloudflare-dns.com": "www.cloudflare.com"
      },
      "servers": [
        {
          "address": "fakedns",
          "domains": [
            "domain:ir",
            "geosite:private",
            "geosite:ir",
            "full:www.cloudflare.com",
            "domain:dynx.pro",
            "geosite:sanctioned"
          ],
          "finalQuery": true
        },
        {
          "tag": "no-filter-dns",
          "address": "https://cloudflare-dns.com/dns-query",
          "timeoutMs": 5000,
          "finalQuery": true
        },
        {
          "address": "localhost",
          "domains": [
            "domain:ir",
            "geosite:private",
            "geosite:ir",
            "full:www.cloudflare.com",
            "domain:dynx.pro"
          ],
          "finalQuery": true
        },
        {
          "tag": "anti-sanction-dns",
          "address": "https://anti-ban.dynx.pro/dns-query",
          "domains": [
            "geosite:sanctioned"
          ],
          "unexpectedIPs": [
            "geoip:irgfw-all-injected-ips",
            "0.0.0.0",
            "::",
            "127.0.0.1",
            "::1"
          ],
          "timeoutMs": 2000,
          "finalQuery": false
        }
      ],
      "queryStrategy": "UseSystem",
      "useSystemHosts": true
    },
    "inbounds": [
      {
        "tag": "dns-in",
        "listen": "127.0.0.1",
        "port": 10853,
        "protocol": "tunnel",
        "settings": {
          "address": "one.one.one.one",
          "port": 53,
          "network": "tcp,udp"
        },
        "streamSettings": {
          "sockopt": {
            "tcpKeepAliveInterval": 1,
            "tcpKeepAliveIdle": 46
          }
        }
      },
      {
        "tag": "socks-in",
        "listen": "127.0.0.1",
        "port": 10808,
        "protocol": "mixed",
        "sniffing": {
          "enabled": true,
          "destOverride": [
            "fakedns"
          ],
          "routeOnly": false
        },
        "settings": {
          "udp": true,
          "ip": "127.0.0.1"
        },
        "streamSettings": {
          "sockopt": {
            "tcpKeepAliveInterval": 1,
            "tcpKeepAliveIdle": 46
          }
        }
      }
    ],
    "outbounds": [
      {
        "tag": "block-out",
        "protocol": "block"
      },
      {
        "tag": "direct-out",
        "protocol": "direct",
        "streamSettings": {
          "sockopt": {
            "domainStrategy": "ForceIP",
            "happyEyeballs": {
              "tryDelayMs": 100,
              "prioritizeIPv6": true,
              "interleave": 2,
              "maxConcurrentTry": 16
            }
          }
        }
      },
      {
        "tag": "dns-out",
        "protocol": "dns",
        "settings": {
          "nonIPQuery": "skip",
          "network": "tcp",
          "address": "one.one.one.one",
          "port": 53
        },
        "streamSettings": {
          "sockopt": {
            "dialerProxy": "full-fragment"
          }
        }
      },
      {
        "tag": "skip-fragment",
        "protocol": "direct",
        "settings": {
          "fragment": {
            "packets": "1-1",
            "length": "130",
            "interval": "190",
            "maxSplit": "4"
          }
        },
        "streamSettings": {
          "sockopt": {
            "dialerProxy": "_chain-skip"
          }
        }
      },
      {
        "tag": "_chain-skip",
        "protocol": "direct",
        "settings": {
          "fragment": {
            "packets": "2-4",
            "length": "1",
            "interval": "1",
            "maxSplit": "130"
          }
        },
        "streamSettings": {
          "sockopt": {
            "domainStrategy": "ForceIP",
            "happyEyeballs": {
              "tryDelayMs": 300,
              "prioritizeIPv6": true,
              "interleave": 2,
              "maxConcurrentTry": 16
            }
          }
        }
      },
      {
        "tag": "full-fragment",
        "protocol": "direct",
        "settings": {
          "fragment": {
            "packets": "1-1",
            "length": "1",
            "interval": "1",
            "maxSplit": "517"
          }
        },
        "streamSettings": {
          "sockopt": {
            "domainStrategy": "ForceIP",
            "happyEyeballs": {
              "tryDelayMs": 300,
              "prioritizeIPv6": true,
              "interleave": 2,
              "maxConcurrentTry": 16
            }
          }
        }
      },
      {
        "tag": "udp-noises",
        "protocol": "direct",
        "settings": {
          "targetStrategy": "ForceIP",
          "noises": [
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1250",
              "delay": "10",
              "applyTo": "ipv4"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            },
            {
              "type": "rand",
              "packet": "1230",
              "delay": "10",
              "applyTo": "ipv6"
            }
          ]
        }
      }
    ],
    "routing": {
      "domainStrategy": "IPOnDemand",
      "rules": [
        {
          "outboundTag": "block-out",
          "domain": [
            "geosite:category-ads-all"
          ]
        },
        {
          "outboundTag": "dns-out",
          "inboundTag": [
            "dns-in"
          ]
        },
        {
          "outboundTag": "dns-out",
          "inboundTag": [
            "socks-in"
          ],
          "port": 53
        },
        {
          "outboundTag": "direct-out",
          "inboundTag": [
            "anti-sanction-dns"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "inboundTag": [
            "no-filter-dns"
          ]
        },
        {
          "outboundTag": "block-out",
          "ip": [
            "geoip:irgfw-block-injected-ips",
            "0.0.0.0",
            "::"
          ]
        },
        {
          "outboundTag": "direct-out",
          "domain": [
            "domain:ir",
            "geosite:private",
            "geosite:ir",
            "domain:dynx.pro"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "direct-out",
          "ip": [
            "geoip:private",
            "geoip:ir"
          ]
        },
        {
          "outboundTag": "udp-noises",
          "network": "udp",
          "protocol": [
            "quic"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "udp-noises",
          "network": "udp",
          "port": "443,2053,2083,2087,2096,8443",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "direct-out",
          "network": "udp",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "protocol": [
            "tls"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "port": "443,2053,2083,2087,2096,8443",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "protocol": [
            "http"
          ],
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "port": "80,8080,8880,2052,2082,2086,2095",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "full-fragment",
          "network": "tcp",
          "ip": [
            "0.0.0.0/0",
            "::/0"
          ]
        },
        {
          "outboundTag": "block-out",
          "network": "tcp,udp"
        }
      ]
    }
  }
]